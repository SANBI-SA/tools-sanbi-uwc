<?xml version="1.0" encoding="utf-8" ?>
<tool id="vcf2neo"
    name="Import SnpEff produced VCF files to a Neo4j Graph database." version="1.0.0">
    <description>Parses VCF files and SnpEff annotation and build a
        Neo4j Graph database.</description>
    <requirements>
      <requirement type="package" version="4.0.0b2">py2neo</requirement>
      <requirement type="package" version="0.0.6">vcf2neo</requirement>
    </requirements>
    <command detect_errors="aggressive"><![CDATA[
        cp -r '${inputDb.extra_files_path}' '${outputDb.files_path}' &&
        python $__tool_directory__/vcf2neo_wrapper.py
          --vcf_dataset_names
          #for $vcf_file in $vcf_inputs
            '${vcf_file.element_identifier}'
          #end for
          --neo4j_db_path '${outputDb.files_path}'
          --user '${__user_email__}'
          --variantset_name '${vcf_inputs.name}'
          --vcf_files
          #for $vcf_file in $vcf_inputs:
            '${vcf_file}'
          #end for
          && python $__tool_directory__/write_db_summary.py
            '${outputDb.files_path}' '${outputDb.name}' >'${outputDb}'
        ]]>
    </command>
    <inputs>
        <param name="vcf_inputs" type="data_collection"
          format="vcf" label="VCF files"
          help="H37Rv TB variants in VCF format" />
        <param name="inputDb" type="data" format="neostore"
          label="Reference TB database (in Neo4j format)"
          help="Reference TB database previously generated by tb2neo" />
    </inputs>
    <outputs>
        <data format="neostore" name="outputDb"/>
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help><![CDATA[
      The vcf2neo_ tool adds variants (in VCF format) to a TB annotation
      database (previously built using tb2neo_). The output is a Neo4j database
      stored as a Galaxy neostore datatype that can be explored with the Neo4j
      Interactive Environment or saved for use outside Galaxy.

      .. _vcf2neo: https://github.com/sanbi-sa/vcf2neo
      .. _tb2neo: https://github.com/sanbi-sa/tb2neo
      ]]></help>
    <citations>
    </citations>
</tool>
